# Ralph Orchestrator Configuration
# This file configures Ralph and its AI agent adapters

# Core orchestrator settings
agent: auto                    # Which agent to use: ollama, gemini, claude, acp, auto (auto prefers ollama)
prompt_file: PROMPT.md         # Path to prompt file
max_iterations: 100000000      # Large cap to avoid safety stop; effectively "run until done" with other limits
max_runtime: 14400             # Maximum runtime in seconds (4 hours)
checkpoint_interval: 5         # Git checkpoint every N iterations
retry_delay: 2                 # Delay between retries in seconds
ollama_model: gemma3:1b        # Default Ollama model to use

# Resource limits
max_tokens: 2000000           # Maximum total tokens (1M)
max_cost: 5.0                 # Maximum cost in USD
context_window: 100000000     # Context window size in tokens
context_threshold: 0.8        # Trigger summarization at 80% of context

# Features
archive_prompts: true         # Archive prompt history
git_checkpoint: true          # Enable git checkpointing
enable_metrics: true          # Enable metrics collection
verbose: true                 # Enable verbose output
dry_run: false                # Test mode without execution

# Telemetry settings
iteration_telemetry: true     # Enable per-iteration telemetry capture
output_preview_length: 500    # Max chars for output preview in telemetry (truncated for privacy)

# Safety settings
max_prompt_size: 10485760     # Max prompt file size (10MB)
allow_unsafe_paths: false     # Allow potentially unsafe prompt paths

# Adapter-specific configurations
adapters:
  ollama:
    enabled: true
    timeout: 300
    max_retries: 3
    args: []
    env: {}

  gemini:
    enabled: false
    timeout: 300
    max_retries: 3
    args: []
    env: {}
  
  claude:
    enabled: false
    timeout: 300              # Timeout in seconds
    max_retries: 3            # Max retry attempts
    tool_permissions:         # Tool permissions for Claude
      allow_all: true         # Allow all tools without approval

  acp:
    enabled: false
    timeout: 300
    tool_permissions:
      agent_command: gemini
      agent_args: []
      permission_mode: allowlist
      permission_allowlist:
        - "fs/read_text_file:*"
        - "fs/write_text_file:runs/*"
        - "terminal/create:bash runs/*/verify.sh"
        - "terminal/create:python tools/*"
        - "terminal/create:git status*"
        - "terminal/create:git rev-parse*"
